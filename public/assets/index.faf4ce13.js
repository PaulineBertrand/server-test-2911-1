var k=Object.defineProperty,E=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var U=(t,n,r)=>n in t?k(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,L=(t,n)=>{for(var r in n||(n={}))R.call(n,r)&&U(t,r,n[r]);if(N)for(var r of N(n))T.call(n,r)&&U(t,r,n[r]);return t},S=(t,n)=>E(t,P(n));import{r as c,j as b,N as p,a as A,u as y,b as O,O as j,R as M,c as h,d as B,e as D,B as H}from"./vendor.68b2a401.js";const V=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};V();const C=c.exports.createContext(),x=()=>c.exports.useContext(C);const e=b.exports.jsx,l=b.exports.jsxs,f=b.exports.Fragment,_=()=>{const{isLoggedIn:t,currentUser:n,removeUser:r}=x();return l("nav",{className:"NavMain",children:[e(p,{className:"logo",to:"/",children:"App name"}),t&&l(f,{children:[e(p,{to:"/profile",children:n&&n.email}),e("button",{onClick:r,children:"Log-Out"})]}),!t&&l(f,{children:[e(p,{to:"/signin",children:"Log in"}),e(p,{to:"/signup",children:"Sign Up"})]})]})},K=()=>e("div",{children:e("h1",{children:"Welcome \u{1F3E1}"})}),F=t=>{const[n,r]=c.exports.useState(t);return[n,s=>{r(S(L({},n),{[s.target.name]:s.target.value}))}]},v=A.create({baseURL:{}.VITE_APP_BACKEND_URL,withCredentials:!0});//! Error handling to use in the catch
function w(t){throw t.response.data&&console.log(t.response&&t.response.data),t}const I=S(L({},v),{signup(t){return v.post("/api/auth/signup",t).then(n=>n.data).catch(w)},isLoggedIn(t){return v.get("/api/auth/me",{headers:{Authorization:`Bearer ${t}`}}).then(n=>n.data).catch(w)},signin(t){return v.post("/api/auth/signin",t).then(n=>n.data).catch(w)}}),$=()=>{const[{email:t,password:n},r]=F({email:"",password:""}),[a,s]=c.exports.useState(null),o=y(),{storeToken:i,authenticateUser:d}=x(),u=g=>{g.preventDefault(),I.signin({email:t,password:n}).then(m=>{console.log(m),i(m.authToken),d(),o("/")}).catch(m=>{s(m.response.data)})};return l(f,{children:[a&&e("h3",{className:"error",children:a.message}),l("form",{onSubmit:u,children:[e("h2",{children:"Signin"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{type:"email",id:"email",name:"email",onChange:r,value:t}),e("label",{htmlFor:"password",children:"Password"}),e("input",{type:"password",id:"password",name:"password",onChange:r,value:n}),e("button",{children:"Submit"})]})]})},q=()=>e($,{}),z=()=>{const[t,n]=F({name:"",email:"",password:""}),[r,a]=c.exports.useState(null),s=y(),o=i=>{i.preventDefault(),I.signup(t).then(()=>{s("/signin")}).catch(d=>{a(d.response.data)})};return l(f,{children:[r&&e("h3",{className:"error",children:r.message}),l("form",{onSubmit:o,children:[e("h2",{children:"Signup"}),e("label",{htmlFor:"name",children:"Name"}),e("input",{onChange:n,value:t.name,type:"text",id:"name",name:"name"}),e("label",{htmlFor:"email",children:"Email"}),e("input",{onChange:n,value:t.email,type:"email",id:"email",name:"email"}),e("label",{htmlFor:"password",children:"Password"}),e("input",{onChange:n,value:t.password,type:"password",id:"password",name:"password"}),e("button",{children:"Submit"})]})]})},W=()=>e(z,{}),G=()=>e("div",{children:e("p",{children:"This is a protected profile"})}),J=()=>{const{isLoggedIn:t,isLoading:n}=x();return n?e("p",{children:"Loading..."}):t?e(j,{}):e(O,{to:"/login"})};function Q(){return l("div",{className:"App",children:[e(_,{}),l(M,{children:[e(h,{path:"/",element:e(K,{})}),e(h,{path:"/signin",element:e(q,{})}),e(h,{path:"/signup",element:e(W,{})}),e(h,{element:e(J,{}),children:e(h,{path:"/profile",element:e(G,{})})})]})]})}const X=({children:t})=>{const[n,r]=c.exports.useState({currentUser:null,isLoading:!0,isLoggedIn:!1});c.exports.useEffect(()=>{a()},[]);const a=()=>{const u=localStorage.getItem("authToken");u?I.isLoggedIn(u).then(g=>{r({currentUser:g,isLoading:!1,isLoggedIn:!0})}).catch(g=>{r({currentUser:null,isLoading:!1,isLoggedIn:!1})}):r({currentUser:null,isLoading:!1,isLoggedIn:!1})},s=()=>{o(),a()},o=()=>{localStorage.removeItem("authToken")},i=u=>{localStorage.setItem("authToken",u)},d={currentUser:n.currentUser,isLoading:n.isLoading,isLoggedIn:n.isLoggedIn,removeUser:s,storeToken:i,authenticateUser:a};return e(C.Provider,{value:d,children:t})};B.render(e(D.StrictMode,{children:e(H,{children:e(X,{children:e(Q,{})})})}),document.getElementById("root"));
